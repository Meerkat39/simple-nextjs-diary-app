# 日記アプリの仕様書（学習者向け）

> ⚠️ 本ドキュメントは生成 AI に学習支援を依頼するためのプロンプト的な役割を持っています。  
> 学習者が理解を深めることを目的としているため、**いきなり答えを提示せず、必要に応じて段階的にヒントを与えてください。**  
> ファイルの作成や編集は学習者が行います。
> コードを提供するときは、適切にコメント文を入れることで、サポートしていください。
> 試行錯誤を促しながら、適切な質問や参考情報を通じてサポートする形で応答してください。

---

このドキュメントは、あなたが作成された日記アプリの機能と、JSON Server を用いたデータ管理、そして Next.js の学習におけるポイントをまとめたものです。  
これは**学習用のプロジェクト**であり、Next.js の理解を深めるためのガイドとなることを意図しています。

---

## 1. アプリケーションの概要

この日記アプリは、日々の出来事や感情、考えを記録するためのシンプルな Web アプリケーションです。日記のエントリーを登録・閲覧・編集・削除できる基本的な機能に加え、検索や気分によるフィルタリング、タグ付け、そして簡単な統計表示機能も備えています。

このアプリでは、データの保存に実際のデータベースではなく、開発に便利な JSON Server というツールを使用します。これにより、データベースの複雑な設定なしに、Next.js の API Routes を介したデータのやり取りを学ぶことができます。

---

## 2. アプリの機能

### 2.1. 日記の作成・編集・削除（CRUD 操作）

- **日記の新規作成**  
  「新規作成」ボタンをクリックすると、日記の入力フォームが表示されます。  
  日付、タイトル（任意）、内容（必須）、その日の気分、関連するタグを入力して日記を保存できます。

- **日記の閲覧**  
  書いた日記は一覧として新しい順に表示されます。  
  各日記にはタイトル、内容の一部、書いた日付、気分アイコン、関連するタグが表示されます。

- **日記の編集**  
  各日記の横にある鉛筆アイコンをクリックすると、その日記の内容を編集フォームに読み込み、修正して再度保存することができます。

- **日記の削除**  
  各日記の横にあるゴミ箱アイコンをクリックすると、確認メッセージが出た後、日記を削除できます。

---

### 2.2. 日記の検索・絞り込み

- **キーワード検索**  
  アプリ上部の検索バーにキーワードを入力すると、そのキーワードがタイトル、内容、またはタグに含まれる日記だけを絞り込んで表示します。

- **気分による絞り込み**  
  気分を選ぶドロップダウン（例: 「全ての気分」「嬉しい」「普通」「悲しい」）を使って、特定の気分で書かれた日記だけを表示できます。

---

### 2.3. その他の便利な機能

- **気分記録**  
  日記を書く際に、その日の気分を「嬉しい」「普通」「悲しい」の中から選んで記録できます。  
  気分はアイコンで視覚的に表示されます。

- **タグ付け**  
  日記に複数のタグ（例: 「学習」「趣味」「旅行」など）を自由に追加できます。  
  タグは入力欄でタイプして Enter を押すことで追加され、不要なタグは簡単に削除できます。

- **統計表示**  
  ヘッダーにある「統計」ボタンをクリックすると、書いた日記の総数、嬉しい日の数、よく使ったタグの数など、簡単な統計情報を見ることができます。  
  気分の分布（どの気分で書いた日記が多いか）も簡易的なグラフで表示されます。

---

## 3. 学習者（あなた）のレベル感と目的

### 3.1. あなたの現在のレベル感

- **HTML/CSS/JavaScript**  
  Web ページの構造、スタイリング、基本的な動的処理の知識があります。

- **React**  
  `useState`（コンポーネント内の状態管理）、`useEffect`（副作用の処理、コンポーネントのライフサイクル）、`props`（コンポーネント間のデータ受け渡し）といった React の基本的な機能と Hooks の使い方を理解し、シンプルなコンポーネントを作成できるレベルです。

---

### 3.2. このアプリを通じた Next.js 学習の目的

この日記アプリのコードは、あなたが React で習得したスキルを土台として、次に学ぶべき Next.js の重要な概念と、Web アプリを「動くもの」にするための API 連携を実践的に学ぶためのものです。

具体的には、以下の点に挑戦し、理解を深めることが目的です。

- **Next.js API Routes の理解と実装**  
  日記の保存や読み込みを、Next.js が提供する API Routes（`pages/api`ディレクトリ内に書く特別なコード）を通じて行うように変更します。  
  これにより、Web アプリの「フロントエンド（見た目）」と「バックエンド（データの処理）」がどのように連携し合うのかを学びます。  
  HTTP メソッド（GET、POST、PUT、DELETE）を使って、日記データの取得、新規作成、更新、削除を行う API エンドポイントを自分で作れるようになります。

- **JSON Server との連携**  
  API Routes の内部から、JSON Server という簡易的なサーバーと通信する方法を学びます。  
  これにより、複雑なデータベースの設定なしに、データの永続化（アプリを閉じてもデータが消えない状態）をシミュレートし、API の動作を確認できます。

- **通常の fetch によるデータ取得**  
  ページ表示時やデータ更新時に、JavaScript の標準的な`fetch`関数を使って、Next.js の API Routes からデータを非同期に取得し、UI に反映させる方法を学びます。  
  `getServerSideProps`のようなサーバーサイドの特別なデータ取得方法に頼らず、クライアントサイドでのデータ管理に焦点を当てます。

- **モダンな Web 開発のワークフロー**  
  React で作られたフロントエンド、Next.js の API Routes で作られた簡易的なバックエンド、そして JSON Server が一体となって動く、実際の Web アプリケーション開発の基本的な流れを体験します。

---

## 4. 開発計画と学習ステップ

この計画は、仕様と Next.js の学習目的を考慮し、基本的な機能から順に実装していく流れです。  
日記アプリの開発を通して、**Next.js の基礎概念や API 連携、データ操作の仕組みを段階的に学習**していくことを目的としています。

---

### 日記アプリ開発計画

1. **JSON Server の起動とデータ構造の確認**

   - `npm run json-server` コマンドで JSON Server を起動し、`http://localhost:3001/diaries` から日記データが取得できることを確認します。
   - `db.json` に日記データのサンプル（`日付`、`タイトル`、`内容`、`気分`、`タグ`など）を追加し、データ構造を明確にします。

2. **Next.js API Routes (GET) の実装**

   - `src/app/api/diaries/route.js` を作成し、JSON Server から全日記データを取得する GET API を実装します。
   - Next.js の API Routes と外部サーバ（JSON Server）の連携方法を学びます。

3. **日記一覧表示コンポーネントの作成**

   - `src/app/page.js` や専用の UI コンポーネントを用いて、手順 2 の API を`fetch`し、一覧表示を行います。
   - 各日記に、タイトル・内容の一部・日付・気分アイコン・タグを表示するよう UI を設計します。

4. **日記作成フォームと API Routes (POST) の実装**

   - 新規作成用の入力フォームコンポーネントを作成します。
   - ユーザーが入力した内容を JSON Server に送信する POST API（`src/app/api/diaries/route.js` に POST メソッドを追加）を実装します。
   - 送信後、自動的に一覧が更新されるようにします。

5. **日記編集フォームと API Routes (PUT) の実装**

   - 編集用のフォーム UI を用意し、対象の日記を読み込み編集できるようにします。
   - `src/app/api/diaries/[id]/route.js` に PUT メソッドを追加し、特定の日記の更新機能を実装します。

6. **日記削除機能と API Routes (DELETE) の実装**

   - 各日記の UI に削除ボタンを設け、クリックで削除確認後に処理を実行します。
   - `src/app/api/diaries/[id]/route.js` に DELETE メソッドを追加し、日記の削除機能を実装します。

7. **検索・絞り込み機能の実装**

   - キーワード検索バーと気分フィルター（ドロップダウン）を UI に追加します。
   - API にクエリパラメータを追加して検索・絞り込み処理を実装します。

8. **タグ付け機能の強化**

   - タグの追加・削除機能の UI とロジックを実装します。
   - API 経由でタグ情報も保存・更新できるようにします。

9. **統計表示機能の実装**

   - 統計ページやモーダルを追加し、日記の総数・気分の分布・タグの使用頻度などを可視化します。
   - クライアントサイドでデータを処理してグラフ表示を行います。

10. **UI/UX の改善とスタイリング**

    - `globals.css` や必要に応じた CSS モジュールで UI 全体を整えます。
    - 気分アイコンやタグなどのビジュアル表現を工夫し、視覚的な分かりやすさを高めます。

11. **最終確認とデバッグ**
    - アプリ全体の動作確認を行い、バグの修正、入力チェック、エラー処理を丁寧に見直します。
    - コードや構造の見直しを通じて、保守性や可読性の向上を目指します。
